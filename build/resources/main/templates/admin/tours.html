<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>

<div th:replace="layout :: header"></div>

<h2>Danh sách Tour</h2>

<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
  <a th:href="@{/admin/tours/new}" class="btn"> + Thêm tour mới</a>

  <form th:action="@{/admin/tours}" method="get">
    <input type="text" name="keyword" th:value="${keyword}" placeholder="Tìm theo tên tour..." size="30" />
    <button type="submit">Tìm kiếm</button>
    <a th:href="@{/admin/tours}" th:if="${keyword}">Xóa lọc</a>
  </form>
</div>

<hr/>

<table border="1" cellpadding="8">
  <tr>
    <th>Ảnh</th>
    <th>Tên tour</th>
    <th>Địa điểm</th>
    <th>Số ngày</th>
    <th>Ngày khởi hành</th>
    <th>Giá</th>
    <th>Trạng thái chỗ</th>
    <th>Chi tiết chuyến đi</th>
    <th>Hành động</th>
  </tr>

  <tr th:each="tour : ${tours}">
    <td>
      <img th:src="${tour.imageUrl}" style="width:100px; height:100px; object-fit:cover;"> </td>

    <td th:text="${tour.name}"></td>
    <td th:text="${tour.location}"></td>
    <td th:text="${tour.days}"></td>
    <td th:text="${tour.startDate}"></td>
    <td th:text="${tour.price} + ' VND'"></td>

    <td>
      <span th:text="${tour.currentPeople} + '/' + ${tour.maxPeople}"></span>
      <br/>
      <span th:if="${tour.currentPeople >= tour.maxPeople}" style="color:red; font-weight:bold;">(Đã đầy)</span>
      <span th:if="${tour.currentPeople < tour.maxPeople}" style="color:green;">(Còn chỗ)</span>
    </td>

    <td style="max-width:300px; white-space:pre-wrap;"
        th:text="${tour.description}">
    </td>
    <td>
      <a th:href="@{'/admin/tours/edit/' + ${tour.id}}">Sửa</a> |
      <form th:action="@{'/admin/tours/delete/' + ${tour.id}}"
            method="post" style="display:inline"
            onsubmit="return confirm('Bạn có chắc chắn muốn xóa không?');"> <button type="submit">Xóa</button>
      </form>
    </td>
  </tr>
</table>

</body>
</html>